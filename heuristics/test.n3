@prefix list: <http://www.w3.org/2000/10/swap/list#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix dfg: <http://rdf.org/dfg#> .
@prefix : <http://example.org/> .

{ ( ?pt ?disc_evt ) dfg:consistentLink true }
<=
{ (1 { ?l dfg:from ?disc_evt_prior ; dfg:to ?disc_evt ; dfg:source dfg:discovered } ()) log:collectAllIn _:t } .

{ ( ?pt ?disc_evt ) dfg:consistentLink true }
<= {
    ?l dfg:from ?disc_evt_prior ; dfg:to ?disc_evt ; dfg:source dfg:discovered .
    ( ?pt ?disc_evt_prior dfg:normative ) dfg:hasFollowing true .
} .

{ ( ?pt ?disc_evt ) dfg:consistentLink true }
<= {
    ?l dfg:from ?disc_evt_prior ; dfg:to ?disc_evt ; dfg:source dfg:discovered .
    ( ?disc_evt_prior ?pt dfg:normative ) dfg:hasFollowing true .
} .

{ ( ?cur ?cur ?src ) dfg:hasFollowing true }
<= { } .

{ ( ?cur ?needle ?src ) dfg:hasFollowing true }
<= {
    ?cur log:notEqualTo ?needle .
    ?l dfg:from ?cur ; dfg:to ?next ; dfg:source ?src .
    ( ?next ?needle ?src ) dfg:hasFollowing true .
} .