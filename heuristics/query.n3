@prefix list: <http://www.w3.org/2000/10/swap/list#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix dfg: <http://rdf.org/dfg#> .
@prefix : <http://example.org/> .

# > run tests
# test data:
# eye test.n3 / rules.n3 --turtle ./data/data1.n3 --query query.n3 --nope
# pilot medical:
# eye rules.n3 --turtle ./data/tc/2/norm.n3 ./data/tc/2/disc.n3 --query query.n3 --nope


# > component tests

# { 
#     ?pt dfg:inNormative true .
#     ( ?pt dfg:normative ) dfg:decisionPoint true .

# } => { ?pt :found true } .

# { 
#     ( ?pt dfg:normative ) dfg:decisionPoint true .
#     ?pt dfg:inDiscovered false .

# } => { ?pt :found true } .

# { 
#     ( dfg:normative dfg:discovered ) log:equalTo ?srcs .
#     ?src list:in ?srcs . 

#     ( ?pt ?src ) dfg:decisionPoint true .
#     # only found in normative / discovered
#     ( { ( ?pt ?found ) dfg:decisionPoint true } { ?found log:equalTo ?src } ) log:forAllIn _:t .

# } => { ?pt dfg:dpOnlyIn ?src } .

# { ( :x :d ) dfg:consistentLink true }
# => { ( :x :d ) dfg:consistentLink true } .

# { ( :z :d ) dfg:consistentLink true }
# => { ( :z :d ) dfg:consistentLink true } .

# { ( :b dfg:decisionPoint dfg:normative () ) dfg:collectAncestors ?anc } 
# => { ( :b dfg:decisionPoint dfg:normative () ) dfg:collectAncestors ?anc } .

# { ( ( :b ) ( :b ) :e dfg:normative ) dfg:forAllPriorBranches true }
# => { ( ( :b ) ( :b ) :e dfg:normative ) dfg:forAllPriorBranches true } .


# - determinant

{ ( :x :b :e ) dfg:determinant true }
=> { ( :x :b :e ) dfg:determinant true } .

# -- test A
# eye rules.n3 --turtle ./data/tests/determA.n3 ./data/tests/determA-pos1.n3 --query query.n3 --nope
# eye rules.n3 --turtle ./data/tests/determA.n3 ./data/tests/determA-neg1.n3 --query query.n3 --nope

# -- test B
# eye rules.n3 --turtle ./data/tests/determB.n3 --query query.n3 --nope

# -- test C
# eye rules.n3 --turtle ./data/tests/determC.n3 --query query.n3 --nope


# > heuristic tests

# (data1.n3)
# { ( ?from ?to ) dfg:inferredEventFromKnownEvent ?known_e }
# => {
#     [
#         dfg:from ?from ;
#         dfg:to ?to ;
#         dfg:source dfg:discovered ;
#         dfg:inferred "inferredEventFromKnownEvent"
#     ]
# } .

# (data2.n3, data3.n3)
# { ( ?pt ?d ) dfg:inferredDecisionFromFollowingEvent ?e } 
# # => { ( ?pt ?d ) dfg:inferredDecisionFromFollowingEvent ?e } .
# => {
#     [
#         dfg:from ?pt ;
#         dfg:to ?d ;
#         dfg:source dfg:discovered ;
#         dfg:inferred [ 
#             dfg:heuristic "inferredDecisionFromFollowingEvent" ;
#             dfg:followingEvent ?e
#         ]
#     ]
# } .

# # (data3.n3)
# { ?pt dfg:inferredDecisionPointFromDecision ?d } 
# # => { ?pt dfg:inferredDecisionPointFromDecision ?d } .
# => {
#     [
#         dfg:from ?pt ;
#         dfg:to ?d ;
#         dfg:source dfg:discovered ;
#         dfg:inferred "inferredDecisionPointFromDecision"
#     ]
# } .